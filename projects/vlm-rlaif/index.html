<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Tuning Large Multimodal Models for Videos using Reinforcement Learning from AI Feedback">
  <meta name="keywords" content="Multimodal Alignment, Video Multimodal Large Model, Reinforcement Learning from AI Feedback">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tuning Large Multimodal Models for Videos using Reinforcement Learning from AI Feedback</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered is-full-width">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title" style="font-size:41px">
            Tuning Large Multimodal Models for Videos using Reinforcement Learning from AI Feedback
          </h1>
          <h1 class="title is-4 publication-title" style="color: #FF0066;">
            ACL 2024 (Oral)
          </h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://dcahn12.github.io" target="_new">Daechul Ahn</a><sup>1,3</sup>,
            </span>
            <span class="author-block">
              <a href="https://yuuraa.github.io" target="_new">Yura Choi</a><sup>1,3</sup>,
            </span>
            <span class="author-block">
              <a href="https://yj-yu.github.io/home/" target="_new">Youngjae Yu</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://dykang.github.io" target="_new">Dongyeop Kang</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://ppolon.github.io">Jonghyun Choi</a><sup>3</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Yonsei University,</span>
            <span class="author-block"><sup>2</sup>University of Minnesota</span>
            <span class="author-block"><sup>3</sup>Seoul National University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper (Coming Soon)</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2402.03746" target="_new"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/yonseivnl/vlm-rlaif" target="_new"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                </a>
              </span>
              <span class="link-block">
                <a href="" target=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Demo (TBU)</span>
                </a>
              </span>
              <!-- Video Link.
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>-->
              <!-- Code Link.
              <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>-->
              <!-- Dataset Link. -->
              <br>
              <span class="link-block">
                <a href="https://huggingface.co/datasets/SNUMPR/vlm_rlaif_datasets/tree/main"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <svg class="svg-inline--fa fa-database fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="database" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"></path></svg><!-- <i class="fas fa-database"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Dataset</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="https://huggingface.co/SNUMPR/vlm_sft_video_llava_7b/tree/main"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <svg class="svg-inline--fa fa-share-square fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="share-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M568.482 177.448L424.479 313.433C409.3 327.768 384 317.14 384 295.985v-71.963c-144.575.97-205.566 35.113-164.775 171.353 4.483 14.973-12.846 26.567-25.006 17.33C155.252 383.105 120 326.488 120 269.339c0-143.937 117.599-172.5 264-173.312V24.012c0-21.174 25.317-31.768 40.479-17.448l144.003 135.988c10.02 9.463 10.028 25.425 0 34.896zM384 379.128V448H64V128h50.916a11.99 11.99 0 0 0 8.648-3.693c14.953-15.568 32.237-27.89 51.014-37.676C185.708 80.83 181.584 64 169.033 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48v-88.806c0-8.288-8.197-14.066-16.011-11.302a71.83 71.83 0 0 1-34.189 3.377c-7.27-1.046-13.8 4.514-13.8 11.859z"></path></svg><!-- <i class="fas fa-share-square"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Model (SFT,7b)</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="https://huggingface.co/SNUMPR/vlm_rlaif_video_llava_7b/tree/main"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <svg class="svg-inline--fa fa-share-square fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="share-square" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M568.482 177.448L424.479 313.433C409.3 327.768 384 317.14 384 295.985v-71.963c-144.575.97-205.566 35.113-164.775 171.353 4.483 14.973-12.846 26.567-25.006 17.33C155.252 383.105 120 326.488 120 269.339c0-143.937 117.599-172.5 264-173.312V24.012c0-21.174 25.317-31.768 40.479-17.448l144.003 135.988c10.02 9.463 10.028 25.425 0 34.896zM384 379.128V448H64V128h50.916a11.99 11.99 0 0 0 8.648-3.693c14.953-15.568 32.237-27.89 51.014-37.676C185.708 80.83 181.584 64 169.033 64H48C21.49 64 0 85.49 0 112v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48v-88.806c0-8.288-8.197-14.066-16.011-11.302a71.83 71.83 0 0 1-34.189 3.377c-7.27-1.046-13.8 4.514-13.8 11.859z"></path></svg><!-- <i class="fas fa-share-square"></i> Font Awesome fontawesome.com -->
                  </span>
                  <span>Model (RLAIF,7b)</span>
                  </a>
              </span>
            </div>
          </div>

          <br>
          <div class="columns is-centered has-text-centered">
            <div class="column is-fullwidth">
              <img src='static/figures/vlm-rlaif.gif' style="margin-left: auto; margin-right: auto; display: block; border-style: none width:100%;max-width:60%" loop="infinite">
              <h5>Illustration of the proposed <b>VLM-RLAIF</b></h5>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <!-- <p>
                Recent advancements in large language models have influenced the development of video large multimodal models (VLMMs). 
                Previous approaches for VLMMs involve Supervised Fine-Tuning (SFT) with instruction-tuned datasets, integrating LLM with visual encoders, and additional learnable parameters. 
                Here, aligning video with text, and vice versa, remains a challenge, primarily due to the insufficient quality and quantity of multimodal instruction-tune data compared to that of text-only. 
                This discrepancy often results in alignments that poorly ground the video content. 
                To address this, we present a novel alignment strategy that employs a multimodal AI system equipped with Reinforcement Learning from AI Feedback (RLAIF), providing self-preference feedback to refine itself and facilitating the alignment of video and text modalities. 
                Our approach uniquely integrates detailed video descriptions as context into a multimodal AI system during preference feedback generation to enrich the understanding of video content, a process we call context-aware reward modeling. 
                Empirical evaluations on various video benchmarks demonstrate that our proposed method outperforms existing approaches, including the SFT model.
            </p> -->
            <p>
              Recent advancements in Large Language Models (LLMs) have driven the development of Video Large Multimodal models (VLMs). 
              While Supervised Fine-Tuning (SFT) for multimodal alignment between video and text has shown promise, challenges persist. 
              The primary obstacle is the scarcity of high-quality video-text instruction-tune data, often resulting in poor grounding of video. 
              Addressing this is crucial for successfully applying VLMs to various real-world video understanding tasks.
            </p>
            <ol type="1">
                <li><b>VLM-RLAIF</b>. <span style="font-size: 95%;">We propose a novel alignment method for VLMs utilizing Reinforcement Learning from AI Feedback (RLAIF) to effectively align video-text modalities. </span></li>
                <li><b>Context-Aware Reward Modeling</b>. <span style="font-size: 95%;">We enhance AI's feedback by introducing context-aware reward modeling, focusing on improved clarity and comprehension in video content understanding. </span></li>  
                <li><b>Enhanced SFT Training</b>. <span style="font-size: 95%;">We enrich the Supervised Fine-Tuning (SFT) model's training by introducing additional instruction-tune data and applying a simple curriculum strategy. </span></li>
                <li><b>Performance</b>. <span style="font-size: 95%;">We demonstrate the effectiveness of our proposed VLM-RLAIF approach on various video understanding benchmarks, showing noticeable improvements over existing methods including SFT model. </span></li>
                <li><b>Open-source</b>. <span style="font-size: 95%;">We make AI preference data, additional visual instruction tuning data (for curriculum learning), our model and code base publicly available. </span></li>
            </ol>  
            <p></p>
            <!-- <br> -->
            <div class="columns is-centered has-text-centered">
              <div class="column is-fullwidth">
                <img src='static/figures/radar.png' style="margin-left: auto; margin-right: auto; display: block; border-style: none width:100%;max-width:60%">
                <h5>Quantitative comparison of VLMMs on various video benchmarks</h5>
              </div>
            </div>
            <!-- <div class="columns is-centered has-text-centered">
              <div class="column is-fullwidth">
                <h2 class="title is-3">Video</h2>
                <iframe width="1120" height="630" src="https://www.youtube.com/embed/4vIrqhuU5XE?si=zG8nzhUl78FZEY-Q" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
              </div>
            </div> -->
          </div>
        </div>
      </div>
      <!--/ Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">Video</h2>
          <div class="publication-video">
            <iframe src="https://www.youtube.com/embed/4vIrqhuU5XE?si=zG8nzhUl78FZEY-Q"
                    frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-widescreen">
    <h1 class="title is-3">VLM-RLAIF Framework</h1>
    <div class="content has-text-justified">
      <p>
        To overcome the limited scalability of human feedback in RLHF, we use AI’s feedback to align multimodality between video and text, reducing the reliance on exhaustive human-annotated preferences. 
        The training procedure of VLM-RLAIF can be summarized into three stages as follows:
        <h5 class="title is-5">1) Supervised fine-tuning (SFT)</h5>
          <p>
            We first fine-tune an LLM, e.g., Vicuna, using supervised learning on synthetically generated video-text instruction-tune data. 
            This involves the integration of a vision encoder with two linear layers and additional learnable parameters using LoRA, into the training process. 
            This fine-tuning allows the model to better follow the instructions.
            Additionally, we improve the SFT process by expanding the instruction-tune data and introducing simple curriculum learning. 
            We refer to this fine-tuned model as the Video Large Multimodal model with SFT or <span style="font-weight:bold">VLM-SFT</span> for short.
          </p>
        <h5 class="title is-5">2) Reward modeling with AI feedback</h5>
          <p>
            A key aspect of the RLAIF involves leveraging a pre-trained AI model to generate human-like preferences between different responses generated from the same input.
            To obtain human-like preference, we employ the VLM-SFT as a judge to assess preferences. 
            Once preferences are judged, we train a reward model (RM) based on preferences using a cross-entropy loss, following the Bradley-Terry model for estimating score functions from pairwise preferences.
            The RM give higher score reward to the better response and lower score reward to the less appropriate one in a pair of responses, thus guiding the policy model using reinforcement learning.
          </p>
        <h5 class="title is-5">3) Reinforcement learning from AI feedback</h5>
          <p>
            We finally fine-tune a supervised policy model, initialized from the VLM-SFT, aiming to optimize the scalar reward output of the trained RM by reinforcement learning. 
            Specifically, we use the Proximal Policy Optimization (PPO) algorithm.
          </p>
      </p>
      <div class="columns is-centered has-text-centered">
        <div class="column is-fullwidth">
          <img src='static/figures/rlaif_feedback_teaser.png' style="margin-left: auto; margin-right: auto; display: block; border-style: none width:100%;max-width:100%">
          <h5>Illustration of the proposed VLM-RLAIF</h5>
        </div>
      </div>
    </div>

  </div>

  <br><br>

  <div class="container is-max-widescreen">
    <h3 class="title is-4">Context-Aware Reward Modeling</h3>
      <p>
        For VLM-SFT to select preference grounded on the video, we argue that a <span style="font-weight:bold">detailed understanding of video content</span> is necessary for more accurate and contextually relevant decisions by the VLM-SFT. 
        However, the current video encoder presents challenges in accurately encoding the temporal details of videos as they are based on the image encoder.
      </p>
      <br>
      <!-- <h3 class="title is-4">Context-aware preference selection and Training the reward model</h3> -->
      <div class="columns is-centered">
        <div class="column is-two-quarter">
          <div class="content has-text-justified">
            <p>
              We propose integrating detailed video descriptions, termed as <span style="font-weight:bold; font-style: italic;">context</span>, into the preference selection workflow to enhance VLMM's contextual clarity. 
              The process involves segmenting the video into clips of up to 20 frames each, generating detailed descriptions for each segment using VLM-SFT with the prompt, ‘Describe this video in detail’. 
              These descriptions are concatenated to form a narrative of the video, which is then provided to a judge model (VLM-SFT) for improved preference selection. 
              This context allows the VLM-SFT to better understand the video content and identify the most suitable response. 
              Integrating context with instruction inputs using a specific prompt, as shown in dotted boxes in the right Figure (2), facilitates the collection of context-aware preferences.
            </p>
            <p>
              The right figure illustrates the three stages of the proposed context-aware reward modeling:
              (1) The SFT model produces two candidate responses from the provided video and question. 
              (2) With the video, question and responses at hand, the SFT model utilize context information and guiding prompt to evaluate the responses. 
              (3) The reward model is trained using the preference pairs generated in the previous step as indicated in orange box. 
              Each stage involves a model's input, indicated by a dotted box, and includes a task-specific prompt, shown in a yellow box. The first stage focuses on response generation, the second on evaluation and selection of the superior response, and the third on training the reward model.
            </p>
          </div>
        </div>
        <div class="column is-fullwidth">
          <img src='static/figures/reward_modeling.png' style="margin-left: auto; margin-right: auto; display: block; border-style: none width:100%;max-width:85%">
          <span style="display: block; text-align: center; width: 100%; font-weight: bold;">Three stages of the context-aware reward modeling</span>
        </div>
        <!-- <div class="column is-two-quarter">
          <img src='static/figures/reward_modeling.png' style="margin-left: auto; margin-right: auto; display: block; border-style: none width:100%;max-width:100%">
        </div> -->
      </div>

      <!-- <h3 class="title is-4">Online Text-Augmentation</h3>
      <div class="columns is-centered">
        <div class="column is-two-quarters">
          <div class="content has-text-justified">
            <p>
              Thanks to our bi-directional Transformers architecture, we can naturally integrate the process of generating pseudo-texts to the process of learning image-to-text model and the text-to-image generation model. 
              In the early epochs, less meaningful sentences are generated, but as training progresses, more meaningful sentences are generated. 
              As a side-product, by supervising the model learning with intermediate goals at each time step, we expect to expedite the convergence of learning.
            </p>
          </div>
        </div>
        <div class="column is-two-quarter">
          <img src='static/figures/ota_simple.jpg' style="margin-left: auto; margin-right: auto; display: block; border-style: none width:100%;max-width:100%">
        </div>
      </div> -->
  </div>
</section>


<section class="hero is-light">
  <div class="hero-body">
    <div class="container is-max-widescreen">
      <h2 class="title is-3">Results</h2>
      <div class="content has-text-justified">
        <p>
          We quantitatively evaluate VLMMs on the video-based generative performance benchmark that measures five criteria of generated text. 
          In specific, these assess the relevance of the model’s output to the video content, its capacity to capture essential details and contextual information, its understanding of temporal sequences, and the consistency in responding to varied yet related queries. 
          The VLM-RLAIF performs on par with GPT-4V (OpenAI, 2023), which requires much more computational resources than ours (i.e., not a fair comparison), and outperforms previous approaches and the VLM-SFT.
        </p>
        <p>
          Moreover, we qualitatively compares the performance of VLM-SFT and VLM-RLAIF, highlighting their multimodal understanding capabilities below Figure. 
          VLM-RLAIF consistently yields more accurate answers than VLM-SFT, 
          The VLM-RLAIF yields responses that are more accurately grounded in the visual input, as highlighted in <span style="color: blue;">blue</span> for accurate responses and <span style="color: red;">red</span> for less accurate ones from VLM-SFT.
        </p>
        <p>
          For more information, please check out the <span style="color: #305fac; font-weight:bold"><a href="https://arxiv.org/pdf/2402.03746" target="_new">paper</a></span>.
        </p>
        <br>

        <div class="columns is-centered has-text-centered">
          <div class="column is-full-width">
            <img src="static/tables/rlaif_result.jpg" width="1200">
            <h5>Quantitative comparison between different VLMMs on video-based generative performance benchmark</h5>
          </div>
        </div>

        <div class="columns is-centered has-text-centered">
          <div class="column is-full-width">
            <img src="static/figures/sft_rlaif.png" width="1100">
            <h5>Qualitative examples of the comparative results between VLM-SFT and VLM-RLAIF in video instruction-following task</h5>
          </div>
        </div>


      </div>
    </div>
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{ahnCYKC24,
  author    = {Ahn, Daechul and Choi, Yura and Yu, Youngjae and Kang, Dongyeop and Choi, Jonghyun},
  title     = {Tuning Large Multimodal Models for Videos using Reinforcement Learning from AI Feedback},
  booktitle = {ACL},
  year      = {2024},
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          The website template is from <a href="https://github.com/nerfies/nerfies.github.io">here</a>.
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>